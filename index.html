<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Macro Calculator â€” The Strength Blueprint</title>

<!-- ===== LAYOUT / STYLE (desktop + mobile) ===== -->
<style>
  :root { --bg:#f7f7f7; --fg:#111; --muted:#666; --line:#e6e6e6; }
  * { box-sizing: border-box; }
  html, body { margin:0; padding:0; }
  body {
    min-height: 100vh;
    background: var(--bg);
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 28px 16px;
  }
  .wrap{
    width:100%;
    max-width: 960px;        /* wider so it never looks squished */
    background:#fff;
    border:1px solid var(--line);
    border-radius:14px;
    box-shadow:0 2px 8px rgba(0,0,0,0.05);
    padding:28px;
  }
  h2{ margin:0 0 16px; font-size:28px; color:var(--fg); }

  /* Form grid that breathes on desktop and collapses on mobile */
  .grid{
    display:grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap:16px 24px;
  }
  @media (max-width: 820px){
    .grid{ grid-template-columns: 1fr; }
  }

  label{ display:block; font-weight:600; font-size:14px; color:var(--fg); margin-bottom:6px; }
  input, select{
    width:100%;
    padding:12px;
    border:1px solid #ccc;
    border-radius:10px;
    font-size:16px;
    background:#fff;
    color:var(--fg);
  }
  .row{ display:flex; align-items:center; gap:14px; flex-wrap:wrap; }
  .checkbox{ display:inline-flex; align-items:center; gap:8px; font-weight:600; }
  .checkbox input{ width:18px; height:18px; }

  /* Macro mode pills */
  .modes{ display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:10px; margin-top:8px; }
  @media (max-width: 820px){ .modes{ grid-template-columns: 1fr; } }
  .pill{
    position:relative; display:flex; align-items:center; min-height:44px;
    padding:8px 12px 8px 46px; border:1px solid var(--line); border-radius:999px;
    background:#fff; font-size:14px;
  }
  .pill input[type=radio]{
    position:absolute; left:14px; top:50%; transform:translateY(-50%);
    margin:0; width:20px; height:20px; accent-color:#111;
  }

  /* Buttons */
  .actions{ display:grid; grid-template-columns: 1fr 1fr; gap:14px; margin-top:12px; }
  @media (max-width: 820px){ .actions{ grid-template-columns: 1fr; } }
  button{
    width:100%; padding:14px; font-size:16px; font-weight:700; border-radius:10px; cursor:pointer;
    border:1px solid #ccc; background:#111; color:#fff;
  }
  .btn-ghost{ background:#fff; color:#111; }

  /* Results */
  #results{ display:none; margin-top:18px; border-top:1px dashed var(--line); padding-top:16px; }
  .cards{ display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:12px; }
  @media (max-width: 820px){ .cards{ grid-template-columns: 1fr 1fr; } }
  .card{ padding:14px; border:1px solid var(--line); border-radius:10px; text-align:center; }
  .card .k{ font-size:12px; color:var(--muted); }
  .card .v{ font-size:20px; font-weight:700; color:var(--fg); }

  table{ width:100%; border-collapse:collapse; margin-top:12px; text-align:center; }
  th,td{ padding:10px; border-bottom:1px solid var(--line); }
  thead tr{ background:#f2f2f2; }
</style>
</head>

<body>
  <div class="wrap">
    <h2>Macro Calculator</h2>

    <!-- TOP GRID -->
    <div class="grid">
      <div>
        <label for="units">Units *</label>
        <select id="units">
          <option value="metric" selected>Metric (kg, cm)</option>
          <option value="imperial">Imperial (lb, ft/in)</option>
        </select>
      </div>

      <div>
        <label>Gender *</label>
        <div class="row" role="group" aria-label="Gender">
          <label class="checkbox"><input type="checkbox" id="male"> Male</label>
          <label class="checkbox"><input type="checkbox" id="female"> Female</label>
        </div>
      </div>

      <div>
        <label for="age">Age (years) *</label>
        <input id="age" type="number" min="12" max="100" />
      </div>

      <div id="metricHeight">
        <label for="heightCm">Height (cm) *</label>
        <input id="heightCm" type="number" min="120" max="230" />
      </div>

      <div id="imperialHeight" style="display:none;">
        <label>Height (ft / in) *</label>
        <div class="row" style="gap:8px;">
          <input id="heightFt" type="number" min="4" max="7" placeholder="ft" style="flex:1 1 120px" />
          <input id="heightIn" type="number" min="0" max="11" placeholder="in" style="flex:1 1 120px" />
        </div>
      </div>

      <div id="metricWeight">
        <label for="weightKg">Weight (kg) *</label>
        <input id="weightKg" type="number" min="35" max="250" />
      </div>

      <div id="imperialWeight" style="display:none;">
        <label for="weightLb">Weight (lb) *</label>
        <input id="weightLb" type="number" min="80" max="550" />
      </div>

      <div>
        <label for="activity">Activity level *</label>
        <select id="activity">
          <option value="">Select...</option>
          <option value="1.2">Sedentary</option>
          <option value="1.375">Light 1-3 d/wk</option>
          <option value="1.55">Moderate 3-5 d/wk</option>
          <option value="1.725">Hard 6-7 d/wk</option>
          <option value="1.9">Very hard (2 sessions per day)</option>
        </select>
      </div>

      <div>
        <label for="goal">Goal *</label>
        <select id="goal">
          <option value="">Select...</option>
          <option value="maintain">Maintain</option>
          <option value="lose_0.25">Lose 0.25 kg / week</option>
          <option value="lose_0.5">Lose 0.5 kg / week</option>
          <option value="lose_0.75">Lose 0.75 kg / week</option>
          <option value="lose_1">Lose 1 kg / week</option>
          <option value="gain_0.25">Gain 0.25 kg / week</option>
          <option value="gain_0.5">Gain 0.5 kg / week</option>
          <option value="gain_0.75">Gain 0.75 kg / week</option>
          <option value="gain_1">Gain 1 kg / week</option>
        </select>
      </div>
    </div>

    <!-- MACRO MODE -->
    <label style="margin-top:14px;">Macro display</label>
    <div class="modes" role="group" aria-label="Macro display">
      <label class="pill"><input type="radio" name="mode" value="balanced" checked> Balanced</label>
      <label class="pill"><input type="radio" name="mode" value="hclf"> High-carb, Low-fat</label>
      <label class="pill"><input type="radio" name="mode" value="hflc"> High-fat, Low-carb</label>
    </div>

    <!-- ACTIONS -->
    <div class="actions">
      <button id="calcBtn" type="button">Calculate</button>
      <button id="resetBtn" type="button" class="btn-ghost">Reset</button>
    </div>

    <!-- RESULTS -->
    <div id="results" aria-live="polite">
      <h3 style="margin:12px 0;">Daily Targets</h3>
      <div class="cards">
        <div class="card"><div class="k">Calories</div><div class="v" id="outCal">-</div></div>
        <div class="card"><div class="k">Protein</div><div class="v" id="outP">-</div></div>
        <div class="card"><div class="k">Carbohydrates</div><div class="v" id="outC">-</div></div>
        <div class="card"><div class="k">Fats</div><div class="v" id="outF">-</div></div>
      </div>
      <table id="details">
        <thead><tr><th>Macro</th><th>Grams</th><th>Calories</th><th>%</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

<!-- ===== LOGIC ===== -->
<script>
document.addEventListener('DOMContentLoaded', function(){
  const $ = id => document.getElementById(id);
  const round = (n,d=0)=>Number.parseFloat(n).toFixed(d);

  // gender toggles
  const male=$('male'), female=$('female');
  male.addEventListener('change',()=>{ if(male.checked) female.checked=false; });
  female.addEventListener('change',()=>{ if(female.checked) male.checked=false; });
  function getSex(){ if(male.checked) return 'male'; if(female.checked) return 'female'; return null; }

  // unit toggle
  const units = $('units');
  const metricHeight = $('metricHeight'), imperialHeight = $('imperialHeight');
  const metricWeight = $('metricWeight'), imperialWeight = $('imperialWeight');
  units.addEventListener('change', ()=>{
    const m = units.value==='metric';
    metricHeight.style.display = m ? '' : 'none';
    imperialHeight.style.display = m ? 'none' : '';
    metricWeight.style.display = m ? '' : 'none';
    imperialWeight.style.display = m ? 'none' : '';
  });

  // kcal delta map (quoted keys so dots are safe)
  function dailyDelta(goal){
    const map = {
      'maintain': 0,
      'lose_0.25': -275,
      'lose_0.5':  -550,
      'lose_0.75': -825,
      'lose_1':   -1100,
      'gain_0.25': 275,
      'gain_0.5':  550,
      'gain_0.75': 825,
      'gain_1':   1100
    };
    return map[goal] || 0;
  }

  function bmrMifflin(sex, kg, cm, age){
    return (10*kg) + (6.25*cm) - (5*age) + (sex==='male' ? 5 : -161);
  }

  function getInputsInMetric(){
    const metric = $('units').value==='metric';
    let cm, kg;
    if(metric){
      cm = Number($('heightCm').value);
      kg = Number($('weightKg').value);
    } else {
      const ft = Number($('heightFt').value||0);
      const inch = Number($('heightIn').value||0);
      cm = (ft*12 + inch) * 2.54;
      const lb = Number($('weightLb').value);
      kg = lb * 0.45359237;
    }
    return { cm, kg };
  }

  function calc(){
    const age = Number($('age').value);
    const sex = getSex();
    const {cm, kg} = getInputsInMetric();
    const activity = Number($('activity').value);
    const goal = $('goal').value;
    const mode = document.querySelector('input[name="mode"]:checked')?.value || 'balanced';

    if(!age || !sex || !cm || !kg || !activity || !goal){
      alert('Please complete all required fields.');
      return;
    }

    const bmr = bmrMifflin(sex, kg, cm, age);
    const tdee = bmr * activity;
    const targetCalories = Math.max(0, tdee + dailyDelta(goal));

    // macros
    let pG = 2.0 * kg;           // protein default
    const pMin = 1.6 * kg;       // floor
    let fG, fFloor;
    if(mode==='balanced'){ fG=0.8*kg; fFloor=0.6*kg; }
    else if(mode==='hclf'){ fG=0.6*kg; fFloor=0.5*kg; }
    else { fG=1.0*kg; fFloor=0.6*kg; }

    let kcalP=pG*4, kcalF=fG*9;
    let carbsKcal = targetCalories - (kcalP + kcalF);

    // Trim fat then protein if remainder negative
    if(carbsKcal < 0){
      const need = -carbsKcal;
      const reducibleFat = Math.max(0, (fG - fFloor)*9);
      const cut = Math.min(need, reducibleFat);
      fG -= cut/9; kcalF -= cut; carbsKcal += cut;
    }
    if(carbsKcal < 0){
      const need = -carbsKcal;
      const reducibleProt = Math.max(0, (pG - pMin)*4);
      const cut = Math.min(need, reducibleProt);
      pG -= cut/4; kcalP -= cut; carbsKcal += cut;
    }

    const cG = Math.max(0, carbsKcal/4);
    const totalKcal = Math.round(pG*4 + fG*9 + cG*4);

    // Outputs
    $('outCal').textContent = totalKcal + ' kcal';
    $('outP').textContent = round(pG);
    $('outC').textContent = round(cG);
    $('outF').textContent = round(fG);

    const pK=pG*4, fK=fG*9, cK=cG*4;
    const pct = k => totalKcal ? ((k/totalKcal)*100) : 0;
    const tbody = document.querySelector('#details tbody');
    tbody.innerHTML = ''
      + '<tr><td>Protein</td><td>'+round(pG)+'</td><td>'+round(pK)+'</td><td>'+round(pct(pK),1)+'%</td></tr>'
      + '<tr><td>Carbohydrates</td><td>'+round(cG)+'</td><td>'+round(cK)+'</td><td>'+round(pct(cK),1)+'%</td></tr>'
      + '<tr><td>Fats</td><td>'+round(fG)+'</td><td>'+round(fK)+'</td><td>'+round(pct(fK),1)+'%</td></tr>';

    $('results').style.display='block';
    $('results').scrollIntoView({behavior:'smooth', block:'start'});
  }

  function resetForm(){
    document.querySelectorAll('input').forEach(i=>{
      if(i.type==='checkbox' || i.type==='radio') i.checked=false;
      else i.value='';
    });
    document.querySelectorAll('select').forEach(s=> s.selectedIndex=0);
    $('units').value='metric';
    metricHeight.style.display=''; imperialHeight.style.display='none';
    metricWeight.style.display=''; imperialWeight.style.display='none';
    $('results').style.display='none';
    ['outCal','outP','outC','outF'].forEach(id=>$(id).textContent='-');
    document.querySelector('#details tbody').innerHTML='';
    document.body.scrollIntoView({behavior:'smooth'});
  }

  $('calcBtn').addEventListener('click', calc);
  $('resetBtn').addEventListener('click', resetForm);
});
</script>
</body>
</html>
